jQuery(function ($) {

    $('.newsletter-signup-form').submit(function (e) {
        e.preventDefault();
        var name = $('.newsletter-signup-form input[name="name"]').val();
        var email = $('.newsletter-signup-form input[name="email"]').val();
        if (email.length > 0 && name.length > 0) {
            if (validator.isValidEmail(email)) {
                NewsletterDatabaseManager.insert(name, email);
            } else {
                Swal.fire(
                    'Hiba!',
                    'A megadott e-mail cím nem megfelelő!',
                    'warning'
                );
            }
        } else {
            Swal.fire(
                'Hiba!',
                'Kérjük, adja meg a nevét és e-mail címét egyaránt!',
                'error'
            );
        }
    });

    // Adatbázis objektum
    var NewsletterDatabaseManager = {
        insert: function (name, email) {
            var data = {
                action: 'newsletter_add_user',
                name: name,
                email: email
            };
            jQuery.post(newsletter_ajax_object.ajax_url, data, function (response) {
                if (response.success === true) {
                    if (response.data.code === 1) {
                        $('.newsletter-signup-form')[0].reset();
                    }
                    Swal.fire(
                        response.data.title,
                        response.data.msg,
                        response.data.style
                    );
                }
            });
        }
    }
    var validator = {
        isValidEmail: function (email) {
            var regex = /^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;
            return regex.test(email);
        }
    }

});